#!/usr/bin/env node
'use strict';

var debug = require('debug')('amb');
var program = require('commander');
var fs = require('fs');
var path = require('path');
var chalk = require('chalk');
var amb = require('../');
var spawn = require('child_process').spawn;
var version = require('../package').version;

program
  .version(version, '-v, --version')
  .usage('subcommand [options]')
  .parse(process.argv);

var subcmd = program.args[0];
debug('amb %s', subcmd);

if (!subcmd) {
  console.log();
  console.log('  amb %s -- ', version, 'Amb is project builder based on SPM@3x');
  program.outputHelp();
  console.log('  Subcommands:');
  console.log();
  console.log('    new            Creates a new project scaffold in PATH');
  console.log('    install        Install dependencies');
  console.log('    build          Build your project');
  console.log();
  return;
}

var bin = path.join(__dirname, 'amb-' + subcmd);
if (fs.existsSync(bin)) {
  // return require('./' + bin);
  var args = process.argv.slice(3);
  spawn(bin, args, {stdio: 'inherit'});
}

debug('subcmd is not valid: $ amb %s', subcmd);
